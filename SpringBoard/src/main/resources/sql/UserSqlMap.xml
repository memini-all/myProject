<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">

<mapper namespace="com.spring.project.user">

	<!-- 회원가입 -->
    <insert id="insertUser" parameterType="userVO" >
		INSERT INTO tbl_suser
			(
				userid
				, userpw
				, username
				, email
				, authority
				, profile_Img
				, is_withdraw
				, loginFaile
				, islock
				, regdate
			)
		VALUES
			(
				#{userid}
				, #{userpw}
				, #{username}
				, #{email}
				, 'US'
				, #{profile_Img}
				, 'N'
				, 0
				, 'N'
				, NOW()
			)
    </insert>

	<!-- 사용자 아이디 조회 - 중복체크 -->
	<select id="selectUserId" parameterType="String" resultType="int">
		SELECT 
			COUNT(*)
		FROM 
			tbl_suser
		WHERE
			userid = #{userid}        
    </select> 
	
	
	<!-- 프로필 이미지 조회 -->
	<select id="selectProfileImg" parameterType="Integer" resultType="String">
		SELECT 
			profile_Img
		FROM 
			tbl_suser
		WHERE
			userno = #{userno}        
    </select> 


	<!-- 회원정보 보기 -->
	<select id="selectUserInfo" parameterType="Integer" resultType="userVO">
		SELECT 
			userno
			, userid
			, userpw
			, username
			, email
			, authority
			, profile_Img
			, is_withdraw
			, loginFaile
			, islock
			, DATE_FORMAT(regdate, '%Y-%m-%d %H:%i') regdate
		FROM
			tbl_suser
		WHERE
			is_withdraw = 'N' AND userno = #{userno}	
	</select>

	
	<!-- 회원정보 수정 -->
	<update id="updateUser" parameterType="userVO">
		UPDATE 
			tbl_suser 
		SET 
            userpw = #{userpw}
            , username = #{username}
            , email = #{email}
            , profile_Img = #{profile_Img}
        WHERE 
        	userno = #{userno}   
	</update>
	
	
	<!--탈퇴할 회원정보 확인 -->
	<select id="selectDeleteUserInfo" parameterType="userVO" resultType="int">
		SELECT 
			COUNT(*)
		FROM
			tbl_suser
		WHERE
			userno = #{userno} AND userpw = #{userpw}
	</select>
	
	<!-- 회원탈퇴 -->
	<update id="deleteUser" parameterType="Integer">
		UPDATE 
			tbl_suser 
		SET 
            is_withdraw = 'Y'
        WHERE 
        	userno = #{userno}   
	</update>

</mapper>